<div id="share-comment-div" >
    <div id="comments-temp">
        <table>
            <tr>
                <td class="comment-td">
                    <div class="tcenter">
                        <i class="icon-user image-font"></i>
                        <p>
                            <span id="share-user">rr</span>
                        </p>
                        <p>
                            <span id="share-rq">rr</span>
                        </p>
                    </div>
                </td>
                <td>
                    <div class="comments-type comments-showContent"></div>
                    <br>
                    <div class="comments-issueContent comments-showContent"></div>
                    <br>
                    <div class="comments-sloveDesc comments-showContent"></div>
                    <br>
                </td>
            </tr>
        </table>
        <hr class="split-line">
        <h3 class="comments-nav">评 论</h3>
        <dl class="mt20" tpsource="#comments"></dl>
    </div>
    <form id="share-comment-form">
        <input name="pid" id="pid" type="hidden"/>
        <textarea id="pjnr" name="pjnr" class="validate" data-options="required:true,validType:'length[1,2000]'" placeholder="说点什么..."></textarea>
    </form>
    <p class="tcenter mt20">
        <b id="share-comment" class="cm-save-btn tj-comment mr15"></b>
        <b id="share-comment-cancel" class="cm-cancel-btn"></b>
    </p>
    <br/>
</div>
<!--评论内容-->
<script type="text/template" id="comments">
    <dt class="pr">
        <i class="icon-user"></i>
    <p>
        <span>{trueName}</span>
        <span>{createDate}</span>
    </p>
    </dt>
    <dd class="comments-pjnr">{pjnr}</dd>
</script>
<script>
    $style(top.path+'/dist/css/multiWin.css');
    var shareViewAction = top.path+'/api/0/feedback/share/view',
            shareCommentAction = top.path+'/api/0/feedback/share/comment',
            shareCommentListAction = top.path+'/api/0/feedback/share/comment_list';

    function intoCommentShare(pid, commentWin) {
        $('#pid').val(pid);
        $get(shareViewAction,{id:pid},function(msg) {
            var shareData = msg.data;
            $('#share-rq').html("共享于 " + shareData.shareDateStr);
            $('#share-user').html(shareData.shareUwerZw);
            $('.comments-type').html('<span class="comment-title">类型</span>：' + shareData.issueTypeZw);
            $('.comments-issueContent').html('<span class="comment-title">内容描述</span>：' + shareData.issueContent);
            $('.comments-sloveDesc').html('<span class="comment-title">解决方法</span>：' + shareData.sloveDesc);
        });
        $post(shareCommentListAction,{pid:pid},function(msg) {
            $('#comments-temp dl').template(msg.data);
        });
        //关闭评论弹窗
        $('#share-comment-cancel').on('click',function(){
            commentWin.$close()
        });
        //保存评论内容
        $('#share-comment').on('click',function () {
            //验证
            $('#share-comment-div .validate').validatebox();
            if($('.validatebox-invalid').length>0){
                return false;
            }
            $post(shareCommentAction,$('#share-comment-form').serializeObject(),function (res) {
                $('#pjnr').val('');
                $post(shareCommentListAction,{pid:$('#pid').val()},function(msg) {
                    $('#comments-temp dl').template(msg.data);
                });
            });
        });

    }
</script>
