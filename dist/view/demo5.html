<!-- simple treeview -->
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="Generator" content="EditPlus®">
    <meta name="Author" content="">
    <meta name="Keywords" content="">
    <meta name="Description" content="">
    <title>tree demo</title>
    <script src='../../lib/jquery.js'></script>
    <script>
        function byid(id){return document.getElementById(id)}

        //1,父节点点击事件,取消上次节点背景色,突出自身背景色,切换logo,切换子节点显示
        var li_click=function(){
            $('li').css('background-color','')
            $(this).css('background-color','tan')

            if(this.style.backgroundImage=="url(styles/tree/folder-open.gif)")
                this.style.backgroundImage="url(styles/tree/folder.gif)"
            else
                this.style.backgroundImage="url(styles/tree/folder-open.gif)"

            $(this).next('ul').slideToggle();
        }

        //2,子节点点击事件,取消上次节点背景色,突出自身背景色,触发节点ID查询
        var subli_click=function(){
            $('li').css('background-color','')
            $(this).css('background-color','tan')
            event4node($(this).attr('id'));
        }

        //3,节点ID查询
        function event4node(id){
            $('#rdiv').html(id);
        }

        //4,装载JSON为子节点
        function append2th(tagdom){
            if($(tagdom).next('ul').length==0){
                var json=[{name:'会议纪要',id:'M'},{name:'行政文件',id:'G'},{name:'党委文件',id:'P'}];
                var html='';
                var model="<li id='{id}' onclick='subli_click.call(this)'>{name}</li>"
                var temp;
                for(var i=0;i<json.length;i++){
                    temp = model.replace('{name}','<label></label>'+json[i].name).replace('{id}','2014'+json[i].id);
                    html +=temp;
                }
                var e = document.createElement("ul");
                e.className='sublist';
                e.innerHTML=html;
                tagdom.parentNode.insertBefore(e,tagdom.nextSibling);
            }
        }

        //5,JS指定ID节点选中事件
        function onechecked(id){
            var e=document.getElementById(id);
            if(e){
                if(id.length==4)
                    li_click.call(e)
                else{
                    var ep=document.getElementById(id.slice(0,4));
                    if($(ep).next('ul').css('display')=='none')
                        li_click.call(ep)
                }
                subli_click.call(e)
            }
        }

        //6,document ready
        function init(){
            append2th(byid('2014'))
            $('li.mainlist').click(li_click);
            $('ul.sublist').children().click(subli_click);
        }
        window.onload=init
    </script>


    <style>
        table,tr,td,th
        {border:2px solid gray;}
        td,th {width:60px;height:30px;}

        /*开始时隐藏子节点*/
        .sublist{display:none;}

        /*去点,设置缩进*/
        ul{
            list-style-type:none;
            padding:0 18px;
            margin:0;
        }

        /*去点,节点图标*/
        li{
            list-style-type:none;
            background:url(styles/tree/leaf.gif) no-repeat;
            /*margin:0,5px*/
        }
        /*去点,父节点图标*/
        .mainlist{
            list-style-type:none;
            background:url(styles/tree/folder.gif) no-repeat 0 0;
            /*margin-left:15px*/
        }

        /*label占据节点空位,留给背景图标*/
        li label,.sublist li label{
            width:16px;
            display:inline-block
        }

        /*节点鼠标移入突出背景色*/
        li:hover{
            background-color:burlywood; /*如果设置为background:tan背景色会覆盖掉背景图片*/
            color:#000;
        }

        /*设置树层高宽,左浮动,背景色*/
        .lefttreediv{
            width:160px;
            height:520px;
            float:left;
            background-color:#dfc184;
        }
        /*右侧内容层*/
        .rightdiv{
            height:520px;
            margin-left:165px;
            background-color:silver;
        }



    </style>
</head>


<body>
<h2>diy tree demo </h2>
<input type='text' id='testid'/>
<input type="button" id="bt1" value="set one checked" onclick="onechecked(byid('testid').value)" />
<hr/>
<div id="lefttreediv" class="lefttreediv">
    <li class='mainlist' id='2015'><label></label>2015</li>
    <ul class='sublist'>
        <li id='2015G'><label></label>行政文件</li>
        <li id='2015P'><label></label>党委文件</li>
        <li id='2015W'><label></label>工会文件</li>
    </ul>
    <li class='mainlist' id='2014'><label></label>2014</li>
    <li class='mainlist' id='2013'><label></label>2013</li>
    <ul class='sublist'>
        <li id='2013G'><label></label>行政文件</li>
        <li id='2013P'><label></label>党委文件</li>
        <li id='2013W'><label></label>工会文件</li>
        <li id='2013I'><label></label>宣传文件</li>
    </ul>
    <li class='mainlist' id='2012'><label></label>2012</li>
    <ul class='sublist'>
        <li id='2012P'><label></label>党委文件</li>
        <li id='2012W'><label></label>工会文件</li>
        <li id='2012I'><label></label>宣传文件</li>
    </ul>
</div>
<div id="rdiv" class="rightdiv">
    <br>//1,静态父节点,静态子节点;			父子节点都是固定的
    <br>//2,动态父节点,静态子节点;			父节点是动态的,每个父节点下有几个子节点是固定的
    <br>//3,动态父节点,动态子节点;			页面打开时,根据查询结果动态生成所有节点
    <br>
    <br>//4,动态父节点,异步子节点;			页面打开时,根据查询结果动态生成父节点,点击再生成子节点,生成后缓存
    <br>//5,动态父节点,异步子节点(不缓存);  页面打开时,根据查询结果动态生成父节点,点击再生成子节点,不缓存,每次点击父都重新获取子节点
    <br>
    <br>/*前3种都是打开页面,一次性给出json数据,节点生成完毕,直到再次刷新页面*/
    <br>/*第4种要多两个点击事件,一是检查是否已生成过,二是异步生成子节点(若没生产过)*/
    <br>/*第5种也多两个点击事件,一是清空已有子节点,二是异步生成子节点*/
    <br/>
    <br/>采用第3种,每次打开页面,一次性加载完毕. 如果在此期间有更新文章,刷新页面,或重载树
</div>
<div style='clear:both'></div>

</body>
</html>